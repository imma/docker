#!/usr/bin/env bash

function main {
  local shome="$(cd -P -- "${BASH_SOURCE%/*}/.." && pwd -P)"
  source "$shome/script/profile"

  local pth_source="${1}"; shift
  local nm_volume="$1"; shift

  docker volume create "${nm_volume}" || true
  exec rsync --progress -ia --delete --exclude .git --exclude results -e "docker run -i -v ${nm_volume}:/sync $* rsync --server -logDtpr --log-format=%i . /sync/." "${pth_source}/." :
}

source sub-chain "$BASH_SOURCE" "$@"
